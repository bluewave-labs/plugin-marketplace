var PluginSlack=function(z,e,a,o){"use strict";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),h=(l,C)=>{const w=a.forwardRef(({color:n="currentColor",size:y=24,strokeWidth:i=2,absoluteStrokeWidth:$,className:P="",children:p,...g},B)=>a.createElement("svg",{ref:B,..._,width:y,height:y,stroke:n,strokeWidth:$?Number(i)*24/Number(y):i,className:["lucide",`lucide-${j(l)}`,P].join(" "),...g},[...C.map(([b,S])=>a.createElement(b,S)),...Array.isArray(p)?p:[p]]));return w.displayName=`${l}`,w};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=h("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=h("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=h("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=h("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=h("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=h("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),t={primary:"#13715B",primaryHover:"#0f604d",primaryLight:"rgba(19, 113, 91, 0.08)",successLight:"rgba(5, 150, 105, 0.1)",error:"#DB504A",errorLight:"rgba(219, 80, 74, 0.1)",textPrimary:"#1A1919",textSecondary:"#344054",textTertiary:"#667085",background:"#ffffff",backgroundSecondary:"#f9fafb",backgroundHover:"#f5f5f5",border:"#d0d5dd",borderLight:"#e5e7eb",disabled:"#E5E7EB"},x={sizes:{sm:"12px",md:"13px"},weights:{medium:500,semibold:600}},d={sm:"4px",md:"8px",lg:"12px",full:"9999px"},H={lg:"0px 4px 24px -4px rgba(16, 24, 40, 0.08), 0px 3px 3px -3px rgba(16, 24, 40, 0.03)"},c={header:{backgroundColor:t.backgroundSecondary,fontWeight:x.weights.semibold,fontSize:x.sizes.sm,color:t.textTertiary,textTransform:"uppercase",padding:"12px 16px"},cell:{fontSize:x.sizes.md,color:t.textSecondary,padding:"12px 16px",borderBottom:`1px solid ${t.borderLight}`},row:{"&:hover":{backgroundColor:t.backgroundHover}}},O=({pluginKey:l="slack",slackClientId:C,slackOAuthUrl:w="https://slack.com/oauth/v2/authorize",onToast:n,apiServices:y})=>{const[i,$]=a.useState([]),[P,p]=a.useState(!1),[g,B]=a.useState([]),[b,S]=a.useState(0),[v,D]=a.useState(5),[N,f]=a.useState(!1),T=y||{get:async r=>({data:await(await fetch(`/api${r}`)).json()}),post:async(r,s)=>({data:await(await fetch(`/api${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}),patch:async(r,s)=>({data:await(await fetch(`/api${r}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}),delete:async r=>{await fetch(`/api${r}`,{method:"DELETE"})}},k=a.useCallback(async()=>{var r;try{p(!0);const s=await T.get(`/plugins/${l}/oauth/workspaces`);$(((r=s.data)==null?void 0:r.data)||[])}catch(s){console.error("Failed to fetch Slack workspaces:",s)}finally{p(!1)}},[l]);a.useEffect(()=>{k()},[k]);const F=()=>{if(!C){console.warn("Slack Client ID not configured");return}const r=encodeURIComponent(`${window.location.origin}/plugins/${l}/manage`),s=encodeURIComponent("incoming-webhook,chat:write"),u=`${w}?client_id=${C}&scope=${s}&redirect_uri=${r}`;window.open(u,"_blank","noopener,noreferrer")},U=async r=>{try{await T.delete(`/plugins/${l}/oauth/workspaces/${r}`),n&&n({variant:"success",body:"Workspace disconnected successfully!"}),k()}catch(s){n&&n({variant:"error",body:s.message||"Failed to disconnect workspace."})}},V=async(r,s)=>{try{await T.patch(`/plugins/${l}/oauth/workspaces/${r}`,{is_active:!s}),n&&n({variant:"success",body:"Workspace status updated successfully!"}),k()}catch(u){n&&n({variant:"error",body:u.message||"Failed to update workspace status."})}},q=async()=>{if(i.length!==0)try{await Promise.all(i.map(r=>T.patch(`/plugins/${l}/oauth/workspaces/${r.id}`,{routing_type:g}))),n&&n({variant:"success",body:`Notification routing updated for all ${i.length} workspace(s)!`}),k()}catch(r){n&&n({variant:"error",body:r.message||"Failed to apply routing settings."})}},G=(r,s)=>{S(s)},J=r=>{D(parseInt(r.target.value,10)),S(0)};return e.jsxs(o.Box,{children:[e.jsx(o.Typography,{variant:"body2",color:"text.secondary",fontSize:13,sx:{mb:3},children:"Connect your Slack workspace and route VerifyWise notifications to specific channels."}),e.jsxs(o.Stack,{direction:"row",justifyContent:"flex-end",spacing:2,sx:{mb:3},children:[e.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),F()},children:e.jsx("img",{alt:"Add to Slack",height:"34",width:"120",src:"https://platform.slack-edge.com/img/add_to_slack.png",srcSet:"https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x"})}),e.jsx(o.Button,{variant:"contained",startIcon:e.jsx(I,{size:18}),onClick:()=>f(!0),disabled:i.length===0,sx:{height:"34px",backgroundColor:t.primary,textTransform:"none",fontSize:x.sizes.md,fontWeight:x.weights.medium,"&:hover":{backgroundColor:t.primaryHover},"&:disabled":{backgroundColor:t.disabled}},children:"Configure"})]}),P?e.jsxs(o.Box,{sx:{display:"flex",alignItems:"center",gap:2,py:4},children:[e.jsx(o.CircularProgress,{size:24}),e.jsx(o.Typography,{fontSize:13,children:"Loading workspaces..."})]}):e.jsx(o.TableContainer,{sx:{border:`1px solid ${t.border}`,borderRadius:d.md},children:e.jsxs(o.Table,{children:[e.jsx(o.TableHead,{sx:{backgroundColor:t.backgroundSecondary},children:e.jsxs(o.TableRow,{children:[e.jsx(o.TableCell,{sx:{...c.header},children:"Team Name"}),e.jsx(o.TableCell,{sx:{...c.header},children:"Channel"}),e.jsx(o.TableCell,{sx:{...c.header},children:"Creation Date"}),e.jsx(o.TableCell,{sx:{...c.header},children:"Active"}),e.jsx(o.TableCell,{sx:{...c.header},children:"Action"})]})}),e.jsx(o.TableBody,{children:i.length>0?i.slice(b*v,b*v+v).map(r=>e.jsxs(o.TableRow,{sx:{...c.row},children:[e.jsx(o.TableCell,{sx:{...c.cell},children:r.team_name}),e.jsxs(o.TableCell,{sx:{...c.cell},children:["#",r.channel]}),e.jsx(o.TableCell,{sx:{...c.cell},children:r.created_at?new Date(r.created_at).toLocaleDateString():"-"}),e.jsx(o.TableCell,{sx:{...c.cell},children:e.jsxs(o.Box,{component:"span",sx:{display:"inline-flex",alignItems:"center",gap:.5,px:1,py:.25,borderRadius:d.full,fontSize:"11px",fontWeight:500,backgroundColor:r.is_active?t.successLight:"rgba(107, 114, 128, 0.1)",color:r.is_active?"#16a34a":t.textTertiary},children:[e.jsx(o.Box,{sx:{width:6,height:6,borderRadius:"50%",backgroundColor:r.is_active?"#16a34a":t.textTertiary}}),r.is_active?"Active":"Inactive"]})}),e.jsx(o.TableCell,{sx:{...c.cell},children:e.jsxs(o.Stack,{direction:"row",spacing:.75,children:[e.jsx(o.Box,{onClick:()=>V(r.id,r.is_active),sx:{width:30,height:30,borderRadius:d.sm,border:`1px solid ${t.border}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:r.is_active?t.primary:t.textTertiary,backgroundColor:t.background,transition:"all 0.15s ease","&:hover":{borderColor:t.primary,backgroundColor:t.primaryLight,color:t.primary}},title:r.is_active?"Disable":"Enable",children:r.is_active?e.jsx(M,{size:16}):e.jsx(W,{size:16})}),e.jsx(o.Box,{onClick:()=>U(r.id),sx:{width:30,height:30,borderRadius:d.sm,border:`1px solid ${t.border}`,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:t.textTertiary,backgroundColor:t.background,transition:"all 0.15s ease","&:hover":{borderColor:t.error,backgroundColor:t.errorLight,color:t.error}},title:"Delete",children:e.jsx(A,{size:14})})]})})]},r.id)):e.jsx(o.TableRow,{children:e.jsx(o.TableCell,{colSpan:5,align:"center",sx:{py:5},children:e.jsxs(o.Box,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1.5},children:[e.jsx(o.Box,{sx:{width:48,height:48,borderRadius:"50%",backgroundColor:t.backgroundSecondary,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(L,{size:24,color:t.textTertiary})}),e.jsx(o.Typography,{sx:{fontSize:"13px",color:t.textSecondary,fontWeight:500},children:"No workspaces connected"}),e.jsx(o.Typography,{sx:{fontSize:"12px",color:t.textTertiary},children:'Click "Add to Slack" above to connect your first workspace.'})]})})})}),i.length>5&&e.jsx(o.TableFooter,{children:e.jsx(o.TableRow,{children:e.jsx(o.TablePagination,{count:i.length,page:b,onPageChange:G,rowsPerPage:v,rowsPerPageOptions:[5,10,15,25],onRowsPerPageChange:J,labelRowsPerPage:"Rows per page",sx:{fontSize:"13px"}})})})]})}),N&&e.jsx(o.Box,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>f(!1),children:e.jsxs(o.Box,{sx:{backgroundColor:t.background,borderRadius:d.lg,maxWidth:"500px",width:"90%",boxShadow:H.lg,overflow:"hidden"},onClick:r=>r.stopPropagation(),children:[e.jsxs(o.Box,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2.5,borderBottom:`1px solid ${t.borderLight}`},children:[e.jsxs(o.Box,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(o.Box,{sx:{width:32,height:32,borderRadius:d.sm,backgroundColor:t.primaryLight,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(I,{size:16,color:t.primary})}),e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"15px",color:t.textPrimary},children:"Notification Routing"})]}),e.jsx(o.Box,{onClick:()=>f(!1),sx:{width:28,height:28,borderRadius:d.sm,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:t.textTertiary,"&:hover":{backgroundColor:t.backgroundHover}},children:e.jsx(E,{size:16})})]}),e.jsxs(o.Box,{sx:{p:2.5},children:[e.jsx(o.Typography,{sx:{fontSize:"13px",color:t.textTertiary,mb:2.5},children:"Configure which notification types go to which Slack channels."}),e.jsxs(o.Stack,{spacing:1.5,children:[e.jsx(o.Typography,{sx:{fontSize:"13px",fontWeight:500,color:t.textSecondary},children:"Apply to all workspaces:"}),e.jsx(o.FormControl,{fullWidth:!0,size:"small",children:e.jsx(o.Select,{multiple:!0,value:g,onChange:r=>{const s=typeof r.target.value=="string"?r.target.value.split(","):r.target.value;B(s)},renderValue:r=>r.length===0?"Select notification types...":`${r.length} type(s) selected`,displayEmpty:!0,sx:{fontSize:"13px","& .MuiOutlinedInput-notchedOutline":{borderColor:t.border},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:t.primary}},children:["Membership and roles","Projects and organizations","Policy reminders and status","Evidence and task alerts","Control or policy changes"].map(r=>e.jsxs(o.MenuItem,{value:r,sx:{fontSize:"13px"},children:[e.jsx(o.Checkbox,{checked:g.indexOf(r)>-1,size:"small",sx:{color:t.primary,"&.Mui-checked":{color:t.primary}}}),e.jsx(o.Typography,{sx:{fontSize:"13px"},children:r})]},r))})})]})]}),e.jsxs(o.Box,{sx:{display:"flex",justifyContent:"flex-end",gap:1.5,p:2.5,borderTop:`1px solid ${t.borderLight}`,backgroundColor:t.backgroundSecondary},children:[e.jsx(o.Button,{variant:"outlined",size:"small",onClick:()=>f(!1),sx:{textTransform:"none",fontSize:"13px",borderColor:t.border,color:t.textSecondary},children:"Cancel"}),e.jsx(o.Button,{variant:"contained",size:"small",onClick:()=>{q(),f(!1)},disabled:g.length===0,sx:{backgroundColor:t.primary,textTransform:"none",fontSize:"13px","&:hover":{backgroundColor:t.primaryHover}},children:"Save Changes"})]})]})})]})};return z.SlackConfiguration=O,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}),z}({},jsxRuntime,React,MUI);
//# sourceMappingURL=index.esm.js.map
