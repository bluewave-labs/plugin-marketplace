var PluginModelLifecycle=function(q,e,s,o,le){"use strict";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ge={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),m=(t,l)=>{const d=s.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:f=2,absoluteStrokeWidth:c,className:u="",children:y,...b},k)=>s.createElement("svg",{ref:k,...ge,width:r,height:r,stroke:n,strokeWidth:c?Number(f)*24/Number(r):f,className:["lucide",`lucide-${ue(t)}`,u].join(" "),...b},[...l.map(([h,F])=>s.createElement(h,F)),...Array.isArray(y)?y:[y]]));return d.displayName=`${t}`,d};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=m("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=m("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=m("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=m("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=m("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=m("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=m("GitCommitVertical",[["path",{d:"M12 3v6",key:"1holv5"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M12 15v6",key:"a9ows0"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=m("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=m("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=m("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=m("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=m("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=m("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=m("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=m("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ve(t,l,d=!0){const[n,r]=s.useState([]),[f,c]=s.useState(!1),[u,y]=s.useState(null),b=s.useCallback(async()=>{var k;if(!(!t||!d||!l)){c(!0),y(null);try{const h=await l.get(`/plugins/model-lifecycle/models/${t}/lifecycle`);r(((k=h.data)==null?void 0:k.data)||h.data||[])}catch(h){y(h.message||"Failed to load lifecycle data")}finally{c(!1)}}},[t,d,l]);return s.useEffect(()=>{b()},[b]),{phases:n,loading:f,error:u,refresh:b}}function Ie(t,l,d=!0){const[n,r]=s.useState(null),[f,c]=s.useState(!1),[u,y]=s.useState(null),b=s.useCallback(async()=>{var k;if(!(!t||!d||!l)){c(!0),y(null);try{const h=await l.get(`/plugins/model-lifecycle/models/${t}/lifecycle/progress`);r(((k=h.data)==null?void 0:k.data)||h.data||null)}catch(h){y(h.message||"Failed to load lifecycle progress")}finally{c(!1)}}},[t,d,l]);return s.useEffect(()=>{b()},[b]),{progress:n,loading:f,error:u,refresh:b}}function Me(t,l=!1,d=!0){const[n,r]=s.useState([]),[f,c]=s.useState(!1),[u,y]=s.useState(null),b=s.useCallback(async()=>{var k;if(!(!d||!t)){c(!0),y(null);try{const h=l?"?includeInactive=true":"",F=await t.get(`/plugins/model-lifecycle/config${h}`);r(((k=F.data)==null?void 0:k.data)||F.data||[])}catch(h){y(h.message||"Failed to load lifecycle config")}finally{c(!1)}}},[l,d,t]);return s.useEffect(()=>{b()},[b]),{phases:n,loading:f,error:u,refresh:b,setPhases:r}}function Ae({phases:t,progress:l,activePhaseId:d,onPhaseSelect:n}){const r=s.useMemo(()=>t.map(c=>{var y;const u=l==null?void 0:l.phases.find(b=>b.phase_id===c.id);return{id:c.id,name:c.name,totalItems:(u==null?void 0:u.total_items)??((y=c.items)==null?void 0:y.length)??0,filledItems:(u==null?void 0:u.filled_items)??0}}),[t,l]),f=s.useCallback(c=>{n(c)},[n]);return e.jsxs(o.Stack,{sx:{width:280,minWidth:280,borderRight:"1px solid #E0E4E9",backgroundColor:"#FCFCFD"},children:[e.jsxs(o.Box,{sx:{px:"20px",py:"16px",borderBottom:"1px solid #E0E4E9"},children:[e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"13px",color:"#344054",mb:"4px"},children:"Lifecycle Progress"}),e.jsxs(o.Typography,{sx:{fontSize:"12px",color:"#667085"},children:[(l==null?void 0:l.completion_percentage)??0,"% complete",l?` (${l.filled_items}/${l.total_items} items)`:""]})]}),e.jsx(o.Stack,{sx:{py:"8px"},children:r.map((c,u)=>{const y=c.id===d,b=c.totalItems>0&&c.filledItems===c.totalItems,k=c.filledItems>0;return e.jsxs(o.Stack,{direction:"row",alignItems:"center",onClick:()=>f(c.id),sx:{px:"20px",py:"10px",gap:"12px",cursor:"pointer",borderLeft:y?"3px solid #13715B":"3px solid transparent",backgroundColor:y?"rgba(19,113,91,0.06)":"transparent","&:hover":{backgroundColor:y?"rgba(19,113,91,0.06)":"#F9FAFB"},transition:"background-color 0.15s ease"},children:[e.jsx(o.Box,{sx:{width:24,height:24,minWidth:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:b||y?"#13715B":"#E0E4E9",color:b||y?"#fff":"#667085",fontSize:"11px",fontWeight:600},children:b?e.jsx(V,{size:14}):u+1}),e.jsxs(o.Stack,{sx:{flex:1,minWidth:0},children:[e.jsx(o.Typography,{sx:{fontSize:"13px",fontWeight:y?600:400,color:"#344054",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c.name}),e.jsxs(o.Typography,{sx:{fontSize:"11px",color:k?"#475467":"#667085"},children:[c.filledItems,"/",c.totalItems," items"]})]})]},c.id)})})]})}const g={primary:"#13715B",textSecondary:"#344054",textTertiary:"#475467",textAccent:"#838c99",bgMain:"#FFFFFF",bgAccent:"#f9fafb",borderLight:"#eaecf0",borderDark:"#d0d5dd",error:"#f04438",errorBg:"#FEE2E2",success:"#17b26a",successBg:"#ecfdf3"},j={fontFamily:"'Inter', system-ui, -apple-system, sans-serif"},X={"& .MuiInputBase-root":{fontFamily:j.fontFamily,fontSize:"13px",borderRadius:"4px"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:g.borderDark},"&:hover fieldset":{borderColor:g.primary},"&.Mui-focused fieldset":{borderColor:g.primary}}},ee={textTransform:"none",fontWeight:500,fontSize:"13px",fontFamily:j.fontFamily,borderRadius:"4px",borderColor:g.borderDark,color:g.textSecondary,"&:hover":{borderColor:g.primary,color:g.primary,backgroundColor:"rgba(19, 113, 91, 0.04)"}},ie={fontFamily:j.fontFamily,fontSize:"12px",fontWeight:500,borderRadius:"4px"};function ae({modelId:t,item:l,onValueChanged:d,apiServices:n}){const r=l.value;switch(l.item_type){case"text":return e.jsx(xe,{modelId:t,item:l,value:r,multiline:!1,onValueChanged:d,apiServices:n});case"textarea":return e.jsx(xe,{modelId:t,item:l,value:r,multiline:!0,onValueChanged:d,apiServices:n});case"documents":return e.jsx(Be,{modelId:t,item:l,value:r,onValueChanged:d,apiServices:n});case"people":return e.jsx(Pe,{modelId:t,item:l,value:r,onValueChanged:d,apiServices:n});case"classification":return e.jsx(De,{modelId:t,item:l,value:r,onValueChanged:d,apiServices:n});case"checklist":return e.jsx(Ee,{modelId:t,item:l,value:r,onValueChanged:d,apiServices:n});case"approval":return e.jsx(_e,{modelId:t,item:l,value:r,onValueChanged:d,apiServices:n});default:return e.jsxs(o.Typography,{color:"text.secondary",variant:"body2",children:["Unsupported field type: ",l.item_type]})}}function xe({modelId:t,item:l,value:d,multiline:n,onValueChanged:r,apiServices:f}){const c=l.config,[u,y]=s.useState((d==null?void 0:d.value_text)??""),[b,k]=s.useState(!1),h=s.useRef((d==null?void 0:d.value_text)??""),F=s.useCallback(async()=>{if(u!==h.current){k(!0);try{await(f==null?void 0:f.put(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}`,{value_text:u||null})),h.current=u,r==null||r()}catch{}finally{k(!1)}}},[u,t,l.id,r,f]);return e.jsx(o.TextField,{placeholder:(c==null?void 0:c.placeholder)||`Enter ${l.name.toLowerCase()}`,value:u,onChange:P=>{c!=null&&c.maxLength&&P.target.value.length>c.maxLength||y(P.target.value)},onBlur:F,multiline:n,rows:n?3:void 0,size:"small",fullWidth:!0,sx:X,InputProps:{endAdornment:b?e.jsx(o.CircularProgress,{size:14,sx:{color:g.primary}}):void 0}})}function Be({modelId:t,item:l,value:d,onValueChanged:n,apiServices:r}){const f=(d==null?void 0:d.files)??[],[c,u]=s.useState(!1),y=s.useRef(null),b=s.useCallback(async h=>{var P,S,$;const F=h.target.files;if(!(!F||F.length===0||!r)){u(!0);try{for(const L of Array.from(F)){const B=new FormData;B.append("file",L),B.append("source","File Manager");const x=await r.post("/files",B,{headers:{"Content-Type":"multipart/form-data"}}),w=((S=(P=x.data)==null?void 0:P.data)==null?void 0:S.id)||(($=x.data)==null?void 0:$.id);await r.post(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}/files`,{fileId:w})}n==null||n()}catch{}finally{u(!1),y.current&&(y.current.value="")}}},[t,l.id,n,r]),k=s.useCallback(async h=>{try{await(r==null?void 0:r.delete(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}/files/${h}`)),n==null||n()}catch{}},[t,l.id,n,r]);return e.jsxs(o.Stack,{sx:{gap:"12px"},children:[f.length>0&&e.jsx(o.Stack,{sx:{gap:"8px"},children:f.map(h=>e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{gap:"10px",p:"10px 12px",borderRadius:"4px",border:`1px solid ${g.borderLight}`,backgroundColor:g.bgAccent},children:[e.jsx(ke,{size:16,color:g.textAccent}),e.jsx(o.Typography,{sx:{flex:1,fontFamily:j.fontFamily,fontSize:"13px",color:g.textSecondary},children:h.filename||`File #${h.file_id}`}),e.jsx(o.IconButton,{size:"small",onClick:()=>k(h.file_id),"aria-label":"Remove file",sx:{color:g.textAccent,"&:hover":{color:g.error}},children:e.jsx(Z,{size:14})})]},h.id))}),e.jsxs(o.Box,{sx:{border:`1px dashed ${g.borderDark}`,borderRadius:"4px",p:"20px 16px",textAlign:"center",cursor:"pointer",transition:"all 0.15s ease","&:hover":{backgroundColor:g.bgAccent,borderColor:g.primary}},onClick:()=>{var h;return(h=y.current)==null?void 0:h.click()},children:[c?e.jsx(o.CircularProgress,{size:20,sx:{color:g.primary}}):e.jsxs(o.Stack,{direction:"row",sx:{gap:"8px",justifyContent:"center",alignItems:"center"},children:[e.jsx(Te,{size:16,color:g.textAccent}),e.jsx(o.Typography,{sx:{fontFamily:j.fontFamily,fontSize:"13px",color:g.textTertiary},children:"Click to upload documents"})]}),e.jsx("input",{ref:y,type:"file",multiple:!0,hidden:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.csv,.txt,.md",onChange:b})]})]})}function Pe({modelId:t,item:l,value:d,onValueChanged:n,apiServices:r}){const f=Array.isArray(d==null?void 0:d.value_json)?d.value_json:[],[c,u]=s.useState(""),[y,b]=s.useState(!1),[k,h]=s.useState([]),[F,P]=s.useState(!0);s.useEffect(()=>{(async()=>{var w;try{const v=await(r==null?void 0:r.get("/users")),W=((w=v==null?void 0:v.data)==null?void 0:w.data)||(v==null?void 0:v.data)||[];h(Array.isArray(W)?W:[])}catch{}finally{P(!1)}})()},[r]);const S=s.useCallback(x=>{const w=k.find(v=>v.id===x);return w?`${w.name} ${w.surname}`:`User #${x}`},[k]),$=s.useCallback(async()=>{if(!(!c||f.find(x=>x.userId===c))){b(!0);try{const x=S(c),w=[...f,{userId:c,userName:x}];await(r==null?void 0:r.put(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}`,{value_json:w})),u(""),n==null||n()}catch{}finally{b(!1)}}},[c,f,t,l.id,n,r,S]),L=s.useCallback(async x=>{b(!0);try{const w=f.filter(v=>v.userId!==x);await(r==null?void 0:r.put(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}`,{value_json:w})),n==null||n()}catch{}finally{b(!1)}},[f,t,l.id,n,r]),B=k.filter(x=>!f.find(w=>w.userId===x.id));return e.jsxs(o.Stack,{sx:{gap:"10px"},children:[f.length>0&&e.jsx(o.Stack,{direction:"row",flexWrap:"wrap",sx:{gap:"8px"},children:f.map(x=>e.jsx(o.Chip,{label:x.userName||S(x.userId),size:"small",variant:"outlined",onDelete:()=>L(x.userId),sx:{...ie,borderColor:g.borderDark,color:g.textSecondary,"& .MuiChip-deleteIcon":{color:g.textAccent,"&:hover":{color:g.error}}}},x.userId))}),e.jsxs(o.Stack,{direction:"row",sx:{gap:"8px"},children:[e.jsxs(o.Select,{value:c,onChange:x=>u(x.target.value),size:"small",displayEmpty:!0,sx:{flex:1,...X,"& .MuiSelect-select":{fontFamily:j.fontFamily,fontSize:"13px"}},disabled:F,children:[e.jsx(o.MenuItem,{value:"",disabled:!0,sx:{fontFamily:j.fontFamily,fontSize:"13px"},children:F?"Loading users...":"Select a user..."}),B.map(x=>e.jsxs(o.MenuItem,{value:x.id,sx:{fontFamily:j.fontFamily,fontSize:"13px"},children:[x.name," ",x.surname," (",x.email,")"]},x.id))]}),e.jsx(o.Button,{variant:"outlined",size:"small",onClick:$,disabled:y||!c,sx:ee,children:"Add"})]}),y&&e.jsx(o.CircularProgress,{size:14,sx:{color:g.primary}})]})}function De({modelId:t,item:l,value:d,onValueChanged:n,apiServices:r}){var P;const f=l.config,c=(f==null?void 0:f.levels)??[],u=((P=d==null?void 0:d.value_json)==null?void 0:P.level)??"",[y,b]=s.useState(u),[k,h]=s.useState(!1),F=s.useCallback(async S=>{b(S),h(!0);try{await(r==null?void 0:r.put(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}`,{value_json:{level:S}})),n==null||n()}catch{}finally{h(!1)}},[t,l.id,n,r]);return e.jsxs(o.Stack,{sx:{gap:"8px"},children:[e.jsx(o.RadioGroup,{value:y,onChange:S=>F(S.target.value),children:c.map(S=>e.jsx(o.FormControlLabel,{value:S,control:e.jsx(o.Radio,{size:"small",sx:{color:g.borderDark,"&.Mui-checked":{color:g.primary}}}),label:e.jsx(o.Typography,{sx:{fontFamily:j.fontFamily,fontSize:"13px",color:g.textSecondary},children:S}),sx:{marginLeft:0}},S))}),k&&e.jsx(o.CircularProgress,{size:14,sx:{color:g.primary}})]})}function Ee({modelId:t,item:l,value:d,onValueChanged:n,apiServices:r}){const f=l.config,c=((f==null?void 0:f.defaultItems)??[]).map(x=>({label:x,checked:!1})),u=Array.isArray(d==null?void 0:d.value_json)?d.value_json:c,[y,b]=s.useState(u.length>0?u:c),[k,h]=s.useState(!1),[F,P]=s.useState(""),S=s.useCallback(async x=>{h(!0);try{await(r==null?void 0:r.put(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}`,{value_json:x})),n==null||n()}catch{}finally{h(!1)}},[t,l.id,n,r]),$=s.useCallback(x=>{const w=y.map((v,W)=>W===x?{...v,checked:!v.checked}:v);b(w),S(w)},[y,S]),L=s.useCallback(()=>{if(!F.trim())return;const x=[...y,{label:F.trim(),checked:!1}];b(x),P(""),S(x)},[y,F,S]),B=s.useCallback(x=>{const w=y.filter((v,W)=>W!==x);b(w),S(w)},[y,S]);return e.jsxs(o.Stack,{sx:{gap:"10px"},children:[y.map((x,w)=>e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{gap:"10px"},children:[e.jsx(o.Checkbox,{checked:x.checked,onChange:()=>$(w),size:"small",sx:{color:g.borderDark,"&.Mui-checked":{color:g.primary},padding:"4px"}}),e.jsx(o.Typography,{sx:{flex:1,fontFamily:j.fontFamily,fontSize:"13px",textDecoration:x.checked?"line-through":"none",color:x.checked?g.textAccent:g.textSecondary},children:x.label}),e.jsx(o.IconButton,{size:"small",onClick:()=>B(w),"aria-label":"Remove item",sx:{color:g.textAccent,"&:hover":{color:g.error}},children:e.jsx(R,{size:14})})]},w)),e.jsxs(o.Stack,{direction:"row",sx:{gap:"10px"},children:[e.jsx(o.TextField,{placeholder:"Add checklist item...",value:F,onChange:x=>P(x.target.value),onKeyDown:x=>x.key==="Enter"&&L(),size:"small",sx:{flex:1,...X}}),e.jsx(o.Button,{variant:"outlined",size:"small",onClick:L,sx:ee,children:"Add"})]}),k&&e.jsx(o.CircularProgress,{size:14,sx:{color:g.primary}})]})}function _e({modelId:t,item:l,value:d,onValueChanged:n,apiServices:r}){const f=Array.isArray(d==null?void 0:d.value_json)?d.value_json:[],[c,u]=s.useState(f),[y,b]=s.useState(!1),[k,h]=s.useState(""),[F,P]=s.useState([]),[S,$]=s.useState(!0);s.useEffect(()=>{(async()=>{var E;try{const A=await(r==null?void 0:r.get("/users")),N=((E=A==null?void 0:A.data)==null?void 0:E.data)||(A==null?void 0:A.data)||[];P(Array.isArray(N)?N:[])}catch{}finally{$(!1)}})()},[r]);const L=s.useCallback(C=>{const E=F.find(A=>A.id===C);return E?`${E.name} ${E.surname}`:`User #${C}`},[F]),B=s.useCallback(async C=>{b(!0);try{await(r==null?void 0:r.put(`/plugins/model-lifecycle/models/${t}/lifecycle/items/${l.id}`,{value_json:C})),n==null||n()}catch{}finally{b(!1)}},[t,l.id,n,r]),x=s.useCallback((C,E)=>{const A=c.map(N=>N.userId===C?{...N,status:E,date:new Date().toISOString()}:N);u(A),B(A)},[c,B]),w=s.useCallback(()=>{if(!k||c.find(A=>A.userId===k))return;const C=L(k),E=[...c,{userId:k,userName:C,status:"pending"}];u(E),h(""),B(E)},[k,c,B,L]),v=s.useCallback(C=>{const E=c.filter(A=>A.userId!==C);u(E),B(E)},[c,B]),W=C=>{switch(C){case"approved":return g.success;case"rejected":return g.error;default:return g.textAccent}},H=C=>{switch(C){case"approved":return g.successBg;case"rejected":return g.errorBg;default:return g.bgAccent}},G=F.filter(C=>!c.find(E=>E.userId===C.id));return e.jsxs(o.Stack,{sx:{gap:"12px"},children:[c.map(C=>e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{gap:"10px",p:"12px 16px",borderRadius:"4px",border:`1px solid ${g.borderLight}`,backgroundColor:g.bgMain},children:[e.jsx(o.Typography,{sx:{flex:1,fontFamily:j.fontFamily,fontSize:"13px",color:g.textSecondary},children:C.userName||L(C.userId)}),e.jsx(o.Chip,{label:C.status.charAt(0).toUpperCase()+C.status.slice(1),size:"small",sx:{...ie,color:W(C.status),backgroundColor:H(C.status),border:"none"}}),C.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(o.IconButton,{size:"small",onClick:()=>x(C.userId,"approved"),sx:{color:g.success,"&:hover":{backgroundColor:g.successBg}},"aria-label":"Approve",children:e.jsx(V,{size:16})}),e.jsx(o.IconButton,{size:"small",onClick:()=>x(C.userId,"rejected"),sx:{color:g.error,"&:hover":{backgroundColor:g.errorBg}},"aria-label":"Reject",children:e.jsx(R,{size:16})})]}),e.jsx(o.IconButton,{size:"small",onClick:()=>v(C.userId),sx:{color:g.textAccent,"&:hover":{color:g.error}},"aria-label":"Remove approver",children:e.jsx(Z,{size:14})})]},C.userId)),e.jsxs(o.Stack,{direction:"row",sx:{gap:"8px"},children:[e.jsxs(o.Select,{value:k,onChange:C=>h(C.target.value),size:"small",displayEmpty:!0,sx:{flex:1,...X,"& .MuiSelect-select":{fontFamily:j.fontFamily,fontSize:"13px"}},disabled:S,children:[e.jsx(o.MenuItem,{value:"",disabled:!0,sx:{fontFamily:j.fontFamily,fontSize:"13px"},children:S?"Loading users...":"Select an approver..."}),G.map(C=>e.jsxs(o.MenuItem,{value:C.id,sx:{fontFamily:j.fontFamily,fontSize:"13px"},children:[C.name," ",C.surname," (",C.email,")"]},C.id))]}),e.jsx(o.Button,{variant:"outlined",size:"small",onClick:w,disabled:y||!k,sx:ee,children:"Add Approver"})]}),y&&e.jsx(o.CircularProgress,{size:14,sx:{color:g.primary}})]})}function Le({phase:t,modelId:l,onValueChanged:d,apiServices:n}){const r=t.items??[];return e.jsxs(o.Stack,{sx:{flex:1,overflowY:"auto",p:"24px",gap:"16px"},children:[e.jsxs(o.Stack,{sx:{gap:"4px"},children:[e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"16px",color:"#344054"},children:t.name}),t.description&&e.jsx(o.Typography,{sx:{fontSize:"13px",color:"#667085"},children:t.description})]}),e.jsx(o.Box,{sx:{borderTop:"1px solid #E0E4E9"}}),r.length>0?e.jsx(o.Stack,{spacing:0,divider:e.jsx(o.Box,{sx:{borderTop:"1px solid #E0E4E9"}}),children:r.map(f=>e.jsxs(o.Stack,{sx:{py:"16px",gap:"10px"},children:[e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{gap:"8px"},children:[e.jsx(o.Typography,{sx:{fontWeight:500,color:"#344054",fontSize:"13px"},children:f.name}),f.is_required&&e.jsx(o.Typography,{sx:{color:"#F04438",fontSize:"11px"},children:"Required"})]}),f.description&&e.jsx(o.Typography,{sx:{color:"#667085",display:"block",fontSize:"12px"},children:f.description}),e.jsx(ae,{modelId:l,item:f,onValueChanged:d,apiServices:n})]},f.id))}):e.jsx(o.Typography,{sx:{textAlign:"center",color:"#667085",py:4},children:"No items configured for this phase"})]})}function $e({phases:t,progress:l,modelId:d,loading:n,onValueChanged:r,apiServices:f}){const[c,u]=s.useState(null);s.useEffect(()=>{t.length>0&&c===null&&u(t[0].id)},[t,c]);const y=s.useMemo(()=>t.find(k=>k.id===c)??null,[t,c]),b=s.useCallback(k=>{u(k)},[]);return n&&t.length===0?e.jsx(o.Stack,{alignItems:"center",sx:{py:4},children:e.jsx(o.CircularProgress,{size:24})}):t.length===0?e.jsx(o.Typography,{sx:{textAlign:"center",color:"#667085",py:4},children:"No lifecycle phases configured. Contact an administrator to set up the model lifecycle."}):e.jsxs(o.Box,{sx:{border:"1px solid #E0E4E9",borderRadius:"4px",backgroundColor:"#fff",overflow:"hidden",display:"flex",flexDirection:{xs:"column",md:"row"},minHeight:400},children:[e.jsx(Ae,{phases:t,progress:l,activePhaseId:c,onPhaseSelect:b}),e.jsx(o.Box,{sx:{flex:1,display:"flex",minWidth:0},children:y?e.jsx(Le,{phase:y,modelId:d,onValueChanged:r,apiServices:f}):e.jsx(o.Stack,{alignItems:"center",justifyContent:"center",sx:{flex:1,p:"24px"},children:e.jsx(o.Typography,{sx:{color:"#667085"},children:"Select a phase from the sidebar"})})})]})}function We({progress:t,onPhaseClick:l}){if(!t||t.phases.length===0)return null;const d=(n,r)=>r===0?"#E0E4E9":n===r?"#079455":n>0?"#2E90FA":"#E0E4E9";return e.jsxs(o.Stack,{sx:{gap:"12px"},children:[e.jsxs(o.Stack,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"14px",color:"#344054"},children:"Lifecycle Progress"}),e.jsxs(o.Typography,{sx:{fontSize:"13px",color:"#667085"},children:[t.completion_percentage,"% complete (",t.filled_items,"/",t.total_items," items)"]})]}),e.jsx(o.Stack,{direction:"row",sx:{gap:"6px",width:"100%"},children:t.phases.map(n=>{const r=n.total_items>0?n.filled_items/n.total_items*100:0,f=d(n.filled_items,n.total_items);return e.jsx(o.Tooltip,{title:`${n.phase_name}: ${n.filled_items}/${n.total_items} items`,arrow:!0,children:e.jsx(o.Box,{onClick:()=>l==null?void 0:l(n.phase_id),sx:{flex:1,height:8,borderRadius:3,overflow:"hidden",backgroundColor:"#E0E4E9",cursor:l?"pointer":"default","&:hover":l?{opacity:.8}:{},position:"relative"},children:e.jsx(o.Box,{sx:{width:`${r}%`,height:"100%",backgroundColor:f,borderRadius:3,transition:"width 0.3s ease"}})})},n.phase_id)})}),e.jsx(o.Stack,{direction:"row",sx:{gap:"6px",width:"100%"},children:t.phases.map(n=>e.jsx(o.Typography,{sx:{flex:1,textAlign:"center",fontSize:"11px",color:"#667085",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:l?"pointer":"default"},onClick:()=>l==null?void 0:l(n.phase_id),children:n.phase_name},n.phase_id))})]})}function me({phase:t,modelId:l,expanded:d,onToggle:n,onValueChanged:r,apiServices:f}){const c=t.items??[],u=c.length,y=c.filter(h=>{const F=h.value;return F?!!(F.value_text||F.value_json||F.files&&F.files.length>0):!1}).length,k=u>0&&y===u?"#079455":y>0?"#2E90FA":"#667085";return e.jsxs(o.Accordion,{expanded:d,onChange:n,disableGutters:!0,sx:{border:"1px solid #E0E4E9",borderRadius:"4px !important","&:before":{display:"none"},boxShadow:"none",mb:"12px",overflow:"hidden"},children:[e.jsx(o.AccordionSummary,{expandIcon:e.jsx(ce,{size:16,style:{transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s ease",color:"#667085"}}),sx:{backgroundColor:d?"#F9FAFB":"#fff","&:hover":{backgroundColor:"#F9FAFB"},px:"16px",py:"12px","& .MuiAccordionSummary-expandIconWrapper":{transform:"none !important"}},children:e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{width:"100%",gap:"12px"},children:[e.jsxs(o.Stack,{sx:{flex:1},children:[e.jsx(o.Typography,{sx:{fontWeight:600,color:"#344054",fontSize:"14px"},children:t.name}),t.description&&e.jsx(o.Typography,{sx:{color:"#667085",fontSize:"12px",mt:"4px"},children:t.description})]}),e.jsx(o.Chip,{label:`${y} / ${u}`,size:"small",variant:"outlined",sx:{color:k,borderColor:k}})]})}),e.jsx(o.AccordionDetails,{sx:{p:0},children:e.jsxs(o.Stack,{spacing:0,divider:e.jsx(o.Box,{sx:{borderTop:"1px solid #E0E4E9"}}),children:[c.map(h=>e.jsxs(o.Stack,{sx:{px:"16px",py:"16px",gap:"10px"},children:[e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{gap:"8px"},children:[e.jsx(o.Typography,{sx:{fontWeight:500,color:"#344054",fontSize:"13px"},children:h.name}),h.is_required&&e.jsx(o.Typography,{sx:{color:"#F04438",fontSize:"11px"},children:"Required"})]}),h.description&&e.jsx(o.Typography,{sx:{color:"#667085",display:"block",fontSize:"12px"},children:h.description}),e.jsx(ae,{modelId:l,item:h,onValueChanged:r,apiServices:f})]},h.id)),c.length===0&&e.jsx(o.Typography,{sx:{textAlign:"center",color:"#667085",py:4},children:"No items configured for this phase"})]})})]})}function pe({modelId:t,apiServices:l}){var B;const{phases:d,loading:n,refresh:r}=ve(t,l),{progress:f,refresh:c}=Ie(t,l),[u,y]=s.useState("stepper"),[b,k]=s.useState(()=>new Set),h=s.useRef(new Map),F=s.useCallback(()=>{r(),c()},[r,c]),P=s.useCallback((x,w)=>{w&&y(w)},[]),S=s.useCallback(x=>{k(w=>{const v=new Set(w);return v.has(x)?v.delete(x):v.add(x),v})},[]),$=s.useCallback(x=>{k(v=>{const W=new Set(v);return W.add(x),W});const w=h.current.get(x);w&&w.scrollIntoView({behavior:"smooth",block:"start"})},[]),L=(B=d[0])==null?void 0:B.id;return L!==void 0&&b.size===0&&d.length>0&&k(new Set([L])),e.jsxs(o.Stack,{sx:{gap:"16px"},children:[e.jsx(o.Stack,{direction:"row",justifyContent:"flex-end",children:e.jsxs(o.ToggleButtonGroup,{value:u,exclusive:!0,onChange:P,size:"small",sx:{"& .MuiToggleButton-root":{px:"12px",py:"4px",fontSize:"13px",textTransform:"none",gap:"6px",color:"#667085",borderColor:"#E0E4E9","&.Mui-selected":{backgroundColor:"#F9FAFB",color:"#344054"}}},children:[e.jsxs(o.ToggleButton,{value:"accordion","aria-label":"Accordion view",children:[e.jsx(Fe,{size:16}),"Accordion"]}),e.jsxs(o.ToggleButton,{value:"stepper","aria-label":"Stepper view",children:[e.jsx(Ce,{size:16}),"Stepper"]})]})}),u==="accordion"?e.jsxs(o.Stack,{sx:{gap:"16px"},children:[e.jsx(We,{progress:f,onPhaseClick:$}),d.map(x=>e.jsx("div",{ref:w=>{w?h.current.set(x.id,w):h.current.delete(x.id)},children:e.jsx(me,{phase:x,modelId:t,expanded:b.has(x.id),onToggle:()=>S(x.id),onValueChanged:F,apiServices:l})},x.id))]}):e.jsx($e,{phases:d,progress:f,modelId:t,loading:n,onValueChanged:F,apiServices:l})]})}const i={primary:"#13715B",primaryDark:"#10614d",textPrimary:"#1c2130",textSecondary:"#344054",textTertiary:"#475467",textAccent:"#838c99",bgMain:"#FFFFFF",bgAlt:"#FCFCFD",bgFill:"#F4F4F4",bgAccent:"#f9fafb",borderLight:"#eaecf0",borderDark:"#d0d5dd",error:"#f04438",errorBg:"#FEE2E2"},M={fontFamily:"'Inter', system-ui, -apple-system, sans-serif"},J={textTransform:"none",fontWeight:500,fontSize:"13px",fontFamily:M.fontFamily,borderRadius:"4px",backgroundColor:i.primary,color:"#fff","&:hover":{backgroundColor:i.primaryDark}},Y={textTransform:"none",fontWeight:400,fontSize:"13px",fontFamily:M.fontFamily,borderRadius:"4px",borderColor:i.borderDark,color:i.textSecondary,"&:hover":{borderColor:i.borderDark,backgroundColor:i.bgFill}},Q={"& .MuiOutlinedInput-root":{backgroundColor:i.bgMain,borderRadius:"4px",fontSize:"13px",fontFamily:M.fontFamily,"& .MuiOutlinedInput-notchedOutline":{borderColor:i.borderDark,borderWidth:"1px"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:i.borderDark},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:i.primary,borderWidth:"1px"}}},je={backgroundColor:i.bgMain,borderRadius:"4px",fontSize:"13px",fontFamily:M.fontFamily,"& .MuiOutlinedInput-notchedOutline":{borderColor:i.borderDark},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:i.borderDark},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:i.primary}},Ne={border:`1px solid ${i.borderLight}`,borderRadius:"4px !important","&:before":{display:"none"},boxShadow:"none",overflow:"hidden"},Oe={backgroundColor:i.bgAccent,px:"16px",py:"10px",minHeight:"44px","& .MuiAccordionSummary-expandIconWrapper":{transform:"none !important",order:-1,mr:"10px"},"& .MuiAccordionSummary-content":{margin:0,alignItems:"center",gap:"10px"}},oe={"& .MuiDialog-paper":{borderRadius:"8px",backgroundColor:i.bgAlt}},Ue=[{value:"text",label:"Text"},{value:"textarea",label:"Text Area"},{value:"documents",label:"Documents"},{value:"people",label:"People"},{value:"classification",label:"Classification"},{value:"checklist",label:"Checklist"},{value:"approval",label:"Approval"}];function qe({apiServices:t}){const{phases:l,loading:d,refresh:n,setPhases:r}=Me(t,!0),[f,c]=s.useState(!1),[u,y]=s.useState(!1),[b,k]=s.useState(""),[h,F]=s.useState(""),[P,S]=s.useState(null),[$,L]=s.useState(""),[B,x]=s.useState("text"),[w,v]=s.useState(!1),[W,H]=s.useState(null),[G,C]=s.useState(null),[E,A]=s.useState(null),[N,te]=s.useState(""),[fe,Ye]=s.useState(new Set),Ke=s.useCallback(p=>{Ye(I=>{const a=new Set(I);return a.has(p)?a.delete(p):a.add(p),a})},[]),Ze=s.useCallback(async()=>{if(!(!b.trim()||!t)){c(!0);try{await t.post("/plugins/model-lifecycle/phases",{name:b.trim(),description:h.trim()||void 0}),k(""),F(""),n()}catch{}finally{c(!1)}}},[b,h,n,t]),Xe=s.useCallback(async()=>{if(!(W===null||!t)){c(!0);try{await t.delete(`/plugins/model-lifecycle/phases/${W}`),n()}catch{}finally{c(!1),H(null)}}},[W,n,t]),ye=s.useCallback(async(p,I)=>{const a=l.findIndex(K=>K.id===p);if(a<0||!t)return;const z=I==="up"?a-1:a+1;if(z<0||z>=l.length)return;const D=[...l],T=[...l];[T[a],T[z]]=[T[z],T[a]],r(T);const _=T.map(K=>K.id);try{await t.put("/plugins/model-lifecycle/phases/reorder",{orderedIds:_})}catch{r(D)}},[l,r,t]),re=s.useCallback(async(p,I)=>{var D;const a=I.trim();if(!a||!t){A(null);return}const z=((D=l.find(T=>T.id===p))==null?void 0:D.name)??"";if(a===z){A(null);return}r(T=>T.map(_=>_.id===p?{..._,name:a}:_)),A(null);try{await t.put(`/plugins/model-lifecycle/phases/${p}`,{name:a})}catch{r(T=>T.map(_=>_.id===p?{..._,name:z}:_))}},[l,r,t]),Je=s.useCallback(async(p,I)=>{if(t){r(a=>a.map(z=>z.id===p?{...z,is_active:I}:z));try{await t.put(`/plugins/model-lifecycle/phases/${p}`,{is_active:I})}catch{r(a=>a.map(z=>z.id===p?{...z,is_active:!I}:z))}}},[r,t]),Qe=s.useCallback(async p=>{if(!(!$.trim()||!t)){c(!0);try{await t.post(`/plugins/model-lifecycle/phases/${p}/items`,{name:$.trim(),item_type:B,is_required:w}),L(""),x("text"),v(!1),S(null),n()}catch{}finally{c(!1)}}},[$,B,w,n,t]),Ve=s.useCallback(async()=>{if(!(G===null||!t)){c(!0);try{await t.delete(`/plugins/model-lifecycle/items/${G}`),n()}catch{}finally{c(!1),C(null)}}},[G,n,t]),Re=s.useCallback(async(p,I)=>{if(t){r(a=>a.map(z=>{var D;return{...z,items:(D=z.items)==null?void 0:D.map(T=>T.id===p?{...T,is_required:I}:T)}}));try{await t.put(`/plugins/model-lifecycle/items/${p}`,{is_required:I})}catch{r(a=>a.map(z=>{var D;return{...z,items:(D=z.items)==null?void 0:D.map(T=>T.id===p?{...T,is_required:!I}:T)}}))}}},[r,t]),he=s.useCallback(async(p,I,a,z)=>{const D=I.findIndex(O=>O.id===a);if(D<0||!t)return;const T=z==="up"?D-1:D+1;if(T<0||T>=I.length)return;const _=[...I];[_[D],_[T]]=[_[T],_[D]],r(O=>O.map(U=>U.id===p?{...U,items:_}:U));const K=_.map(O=>O.id);try{await t.put(`/plugins/model-lifecycle/phases/${p}/items/reorder`,{orderedIds:K})}catch{r(O=>O.map(U=>U.id===p?{...U,items:I}:U))}},[r,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(o.Stack,{sx:{gap:"16px"},children:[d?e.jsx(o.Stack,{alignItems:"center",sx:{py:2},children:e.jsx(o.CircularProgress,{size:24,sx:{color:i.primary}})}):l.length===0?e.jsx(o.Typography,{sx:{fontSize:"13px",fontFamily:M.fontFamily,color:i.textTertiary},children:"No lifecycle phases configured yet. Click the button below to add phases."}):e.jsxs(o.Stack,{sx:{gap:"8px"},children:[e.jsxs(o.Typography,{sx:{fontWeight:600,fontSize:"13px",fontFamily:M.fontFamily,color:i.textSecondary},children:["Configured Phases (",l.filter(p=>p.is_active).length," active)"]}),l.map((p,I)=>{var a;return e.jsxs(o.Box,{sx:{display:"flex",alignItems:"center",gap:"12px",py:"8px",px:"12px",backgroundColor:p.is_active?i.bgAccent:i.bgFill,borderRadius:"4px",border:`1px solid ${i.borderLight}`,opacity:p.is_active?1:.6},children:[e.jsxs(o.Typography,{sx:{fontSize:"12px",fontWeight:600,fontFamily:M.fontFamily,color:i.textAccent,minWidth:"20px"},children:[I+1,"."]}),e.jsx(o.Typography,{sx:{flex:1,fontSize:"13px",fontWeight:500,fontFamily:M.fontFamily,color:i.textPrimary},children:p.name}),e.jsx(o.Chip,{label:`${((a=p.items)==null?void 0:a.length)||0} items`,size:"small",sx:{fontSize:"11px",fontFamily:M.fontFamily,height:"20px",backgroundColor:i.bgFill,color:i.textTertiary,borderRadius:"4px"}}),!p.is_active&&e.jsx(o.Chip,{label:"Inactive",size:"small",sx:{fontSize:"11px",fontFamily:M.fontFamily,height:"20px",backgroundColor:i.errorBg,color:i.error,borderRadius:"4px"}})]},p.id)})]}),e.jsx(o.Button,{variant:"outlined",startIcon:e.jsx(ze,{size:16}),onClick:()=>y(!0),sx:{...Y,alignSelf:"flex-start"},children:"Configure Phases"})]}),e.jsxs(o.Dialog,{open:u,onClose:()=>y(!1),maxWidth:"md",fullWidth:!0,sx:oe,PaperProps:{sx:{maxHeight:"85vh"}},children:[e.jsxs(o.DialogTitle,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${i.borderLight}`,py:"12px",px:"20px"},children:[e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"16px",fontFamily:M.fontFamily,color:i.textPrimary},children:"Configure Model Lifecycle"}),e.jsx(o.IconButton,{onClick:()=>y(!1),size:"small","aria-label":"Close",sx:{color:i.textTertiary},children:e.jsx(R,{size:18})})]}),e.jsx(o.DialogContent,{sx:{p:"20px"},children:d&&l.length===0?e.jsx(o.Stack,{alignItems:"center",sx:{py:4},children:e.jsx(o.CircularProgress,{sx:{color:i.primary}})}):e.jsxs(o.Stack,{sx:{gap:"12px"},children:[l.map((p,I)=>e.jsxs(o.Accordion,{expanded:fe.has(p.id),onChange:()=>Ke(p.id),disableGutters:!0,sx:{...Ne,opacity:p.is_active?1:.6},children:[e.jsxs(o.AccordionSummary,{sx:Oe,children:[e.jsx(ce,{size:16,color:i.textTertiary,style:{transform:fe.has(p.id)?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s ease"}}),E===p.id?e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{flex:1,gap:"6px",mr:"8px"},onClick:a=>a.stopPropagation(),children:[e.jsx(o.TextField,{value:N,onChange:a=>te(a.target.value),onBlur:()=>re(p.id,N),onKeyDown:a=>{a.key==="Enter"?re(p.id,N):a.key==="Escape"&&A(null)},autoFocus:!0,size:"small",sx:{...Q,flex:1}}),e.jsx(o.IconButton,{size:"small",onClick:()=>re(p.id,N),"aria-label":"Save phase name",sx:{color:i.primary},children:e.jsx(V,{size:16})})]}):e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{flex:1,gap:"6px","&:hover .phase-edit-icon":{opacity:1}},children:[e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"13px",fontFamily:M.fontFamily,color:i.textPrimary,cursor:"text"},onDoubleClick:a=>{a.stopPropagation(),A(p.id),te(p.name)},children:p.name}),e.jsx(o.IconButton,{className:"phase-edit-icon",size:"small",sx:{opacity:0,transition:"opacity 0.2s",p:"2px",color:i.textTertiary},onClick:a=>{a.stopPropagation(),A(p.id),te(p.name)},"aria-label":"Edit phase name",children:e.jsx(Se,{size:14})})]}),e.jsx(o.FormControlLabel,{control:e.jsx(o.Switch,{size:"small",checked:p.is_active,onChange:a=>{a.stopPropagation(),Je(p.id,a.target.checked)},sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:i.primary},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:i.primary}}}),label:e.jsx(o.Typography,{sx:{fontSize:"12px",fontFamily:M.fontFamily,color:i.textTertiary},children:"Active"}),onClick:a=>a.stopPropagation(),sx:{mr:0}}),e.jsx(o.IconButton,{size:"small",disabled:I===0,onClick:a=>{a.stopPropagation(),ye(p.id,"up")},"aria-label":"Move phase up",sx:{opacity:I===0?.4:1,color:i.textTertiary},children:e.jsx(ne,{size:16})}),e.jsx(o.IconButton,{size:"small",disabled:I===l.length-1,onClick:a=>{a.stopPropagation(),ye(p.id,"down")},"aria-label":"Move phase down",sx:{opacity:I===l.length-1?.4:1,color:i.textTertiary},children:e.jsx(se,{size:16})}),e.jsx(o.IconButton,{size:"small",onClick:a=>{a.stopPropagation(),H(p.id)},sx:{color:i.error},"aria-label":"Delete phase",children:e.jsx(Z,{size:16})})]}),e.jsx(o.AccordionDetails,{sx:{px:"16px",py:"12px",backgroundColor:i.bgMain},children:e.jsxs(o.Stack,{spacing:0,children:[(p.items??[]).map((a,z)=>{var D,T;return e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{gap:"12px",py:"10px",borderBottom:`1px solid ${i.borderLight}`},children:[e.jsx(o.Typography,{sx:{flex:1,fontSize:"13px",fontFamily:M.fontFamily,color:i.textSecondary},children:a.name}),e.jsx(o.Chip,{label:a.item_type,size:"small",variant:"outlined",sx:{fontSize:"11px",fontFamily:M.fontFamily,borderColor:i.borderDark,color:i.textTertiary,borderRadius:"4px"}}),e.jsx(o.FormControlLabel,{control:e.jsx(o.Switch,{size:"small",checked:a.is_required,onChange:_=>Re(a.id,_.target.checked),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:i.primary},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:i.primary}}}),label:e.jsx(o.Typography,{sx:{fontSize:"11px",fontFamily:M.fontFamily,color:i.textTertiary},children:"Required"}),sx:{mr:0}}),e.jsxs(o.Stack,{direction:"row",alignItems:"center",sx:{gap:"4px",pl:"12px",borderLeft:`1px solid ${i.borderLight}`},children:[e.jsx(o.IconButton,{size:"small",disabled:z===0,onClick:()=>he(p.id,p.items??[],a.id,"up"),"aria-label":"Move item up",sx:{opacity:z===0?.4:1,color:i.textTertiary},children:e.jsx(ne,{size:14})}),e.jsx(o.IconButton,{size:"small",disabled:z===(((D=p.items)==null?void 0:D.length)??0)-1,onClick:()=>he(p.id,p.items??[],a.id,"down"),"aria-label":"Move item down",sx:{opacity:z===(((T=p.items)==null?void 0:T.length)??0)-1?.4:1,color:i.textTertiary},children:e.jsx(se,{size:14})}),e.jsx(o.IconButton,{size:"small",onClick:()=>C(a.id),sx:{color:i.error},"aria-label":"Delete item",children:e.jsx(Z,{size:14})})]})]},a.id)}),P===p.id?e.jsxs(o.Stack,{direction:"row",sx:{gap:"8px",pt:"12px"},alignItems:"center",children:[e.jsx(o.TextField,{placeholder:"Item name",value:$,onChange:a=>L(a.target.value),size:"small",sx:{...Q,flex:1}}),e.jsx(o.Select,{value:B,onChange:a=>x(a.target.value),size:"small",sx:{...je,minWidth:120},children:Ue.map(a=>e.jsx(o.MenuItem,{value:a.value,sx:{fontSize:"13px"},children:a.label},a.value))}),e.jsx(o.FormControlLabel,{control:e.jsx(o.Switch,{size:"small",checked:w,onChange:a=>v(a.target.checked),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:i.primary},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:i.primary}}}),label:e.jsx(o.Typography,{sx:{fontSize:"11px",fontFamily:M.fontFamily,color:i.textTertiary},children:"Req"}),sx:{ml:"4px"}}),e.jsx(o.Button,{variant:"contained",size:"small",onClick:()=>Qe(p.id),disabled:!$.trim()||f,sx:J,children:"Add"}),e.jsx(o.Button,{variant:"text",size:"small",onClick:()=>{S(null),L("")},sx:{...Y,border:"none"},children:"Cancel"})]}):e.jsx(o.Button,{variant:"text",size:"small",startIcon:e.jsx(de,{size:14}),onClick:()=>S(p.id),sx:{alignSelf:"flex-start",mt:"12px",textTransform:"none",fontSize:"13px",fontFamily:M.fontFamily,color:i.primary,"&:hover":{backgroundColor:i.bgAccent}},children:"Add item"})]})})]},p.id)),e.jsxs(o.Box,{sx:{border:`1px dashed ${i.borderDark}`,borderRadius:"4px",p:"16px",backgroundColor:i.bgMain},children:[e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"13px",fontFamily:M.fontFamily,color:i.textSecondary,mb:"12px"},children:"Add new phase"}),e.jsxs(o.Stack,{sx:{gap:"10px"},children:[e.jsx(o.TextField,{placeholder:"Phase name",value:b,onChange:p=>k(p.target.value),size:"small",fullWidth:!0,sx:Q}),e.jsx(o.TextField,{placeholder:"Description (optional)",value:h,onChange:p=>F(p.target.value),size:"small",multiline:!0,rows:2,fullWidth:!0,sx:Q}),e.jsx(o.Button,{variant:"contained",size:"small",startIcon:e.jsx(de,{size:14}),onClick:Ze,disabled:!b.trim()||f,sx:{...J,alignSelf:"flex-start"},children:"Create phase"})]})]})]})}),e.jsx(o.DialogActions,{sx:{px:"20px",py:"12px",borderTop:`1px solid ${i.borderLight}`},children:e.jsx(o.Button,{variant:"outlined",onClick:()=>y(!1),sx:Y,children:"Close"})})]}),e.jsxs(o.Dialog,{open:W!==null,onClose:()=>H(null),sx:oe,children:[e.jsx(o.DialogTitle,{sx:{fontWeight:600,fontSize:"16px",fontFamily:M.fontFamily,color:i.textPrimary},children:"Delete phase"}),e.jsx(o.DialogContent,{children:e.jsx(o.Typography,{sx:{fontSize:"13px",fontFamily:M.fontFamily,color:i.textSecondary},children:"Delete this phase and all its items? This cannot be undone."})}),e.jsxs(o.DialogActions,{sx:{px:"20px",py:"12px"},children:[e.jsx(o.Button,{onClick:()=>H(null),sx:Y,children:"Cancel"}),e.jsx(o.Button,{onClick:Xe,variant:"contained",disabled:f,sx:{...J,backgroundColor:i.error,"&:hover":{backgroundColor:"#dc2626"}},children:"Delete"})]})]}),e.jsxs(o.Dialog,{open:G!==null,onClose:()=>C(null),sx:oe,children:[e.jsx(o.DialogTitle,{sx:{fontWeight:600,fontSize:"16px",fontFamily:M.fontFamily,color:i.textPrimary},children:"Delete item"}),e.jsx(o.DialogContent,{children:e.jsx(o.Typography,{sx:{fontSize:"13px",fontFamily:M.fontFamily,color:i.textSecondary},children:"Delete this item? This cannot be undone."})}),e.jsxs(o.DialogActions,{sx:{px:"20px",py:"12px"},children:[e.jsx(o.Button,{onClick:()=>C(null),sx:Y,children:"Cancel"}),e.jsx(o.Button,{onClick:Ve,variant:"contained",disabled:f,sx:{...J,backgroundColor:i.error,"&:hover":{backgroundColor:"#dc2626"}},children:"Delete"})]})]})]})}const He=({modelId:t})=>{const l=le.useNavigate(),d=n=>{n.stopPropagation(),l(`/model-inventory/models/${t}`)};return e.jsx(o.Tooltip,{title:"View Lifecycle",arrow:!0,placement:"top",children:e.jsx(o.IconButton,{size:"small",onClick:d,sx:{color:"#667085","&:hover":{color:"#13715B",backgroundColor:"rgba(19, 113, 91, 0.08)"}},children:e.jsx(we,{size:16})})})};function Ge({modelId:t,apiServices:l}){const d=o.useTheme(),n=le.useNavigate(),[r,f]=s.useState(null),[c,u]=s.useState(!0);return s.useEffect(()=>{if(!t||!l)return;(async()=>{var b;u(!0);try{const k=await l.get(`/modelInventory/${t}`);f(((b=k.data)==null?void 0:b.data)||k.data)}catch(k){console.error("Failed to fetch model:",k)}finally{u(!1)}})()},[t,l]),c?e.jsx(o.Stack,{alignItems:"center",justifyContent:"center",sx:{py:"64px"},children:e.jsx(o.CircularProgress,{})}):r?e.jsxs(o.Stack,{spacing:0,sx:{gap:"16px",maxWidth:"1400px",width:"100%"},children:[e.jsx(o.Box,{sx:{border:`1px solid ${d.palette.divider}`,borderRadius:"4px",p:"20px",backgroundColor:d.palette.background.paper},children:e.jsxs(o.Stack,{sx:{gap:"16px"},children:[e.jsxs(o.Box,{component:"button",onClick:()=>n("/model-inventory"),sx:{display:"flex",alignItems:"center",gap:"8px",background:"none",border:"none",cursor:"pointer",padding:0,color:d.palette.text.secondary,fontSize:"14px","&:hover":{color:d.palette.text.primary}},children:[e.jsx(be,{size:16}),"Back to Model Inventory"]}),e.jsx(o.Stack,{direction:"row",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",sx:{gap:"16px"},children:e.jsxs(o.Stack,{sx:{gap:"6px"},children:[e.jsx(o.Typography,{sx:{fontWeight:600,fontSize:"16px",color:d.palette.text.primary},children:r.model||r.provider_model}),e.jsxs(o.Stack,{direction:"row",sx:{gap:"16px"},children:[r.provider&&e.jsxs(o.Typography,{sx:{fontSize:"13px",color:d.palette.text.secondary},children:["Provider: ",e.jsx("strong",{children:r.provider})]}),r.version&&e.jsxs(o.Typography,{sx:{fontSize:"13px",color:d.palette.text.secondary},children:["Version: ",e.jsx("strong",{children:r.version})]})]})]})})]})}),e.jsx(pe,{modelId:t,apiServices:l})]}):e.jsx(o.Stack,{alignItems:"center",justifyContent:"center",sx:{py:"64px"},children:e.jsx(o.Typography,{children:"Model not found"})})}return q.ModelLifecycleConfig=qe,q.ModelLifecycleDetail=Ge,q.ModelLifecycleTab=pe,q.ViewLifecycleButton=He,Object.defineProperty(q,Symbol.toStringTag,{value:"Module"}),q}({},jsxRuntime,React,MUI,ReactRouterDOM);
//# sourceMappingURL=index.esm.js.map
